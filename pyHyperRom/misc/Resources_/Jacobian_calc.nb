(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12992,        390]
NotebookOptionsPosition[     11810,        366]
NotebookOutlinePosition[     12153,        381]
CellTagsIndexPosition[     12110,        378]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Jacobian1D", ",", "Jacobian2D", ",", "Jacobian3D"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9073500837534313`*^9, 3.907350094137292*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"7b738d86-d858-4b39-b06e-38020fb0a88a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "symbolic", " ", "variables"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xi", "=", 
     RowBox[{"Symbol", "[", "\"\<xi\>\"", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"eta", "=", 
     RowBox[{"Symbol", "[", "\"\<eta\>\"", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"zeta", "=", 
     RowBox[{"Symbol", "[", "\"\<zeta\>\"", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9073500837534313`*^9, 3.9073500996248903`*^9}, 
   3.9073503450531445`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"fcc7a3ef-33f9-47c9-b50e-bbb5e62ca596"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"coords1D", "=", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}]}], ";", "\n", 
   RowBox[{"coords2D", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "y2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "y3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x4", ",", "y4"}], "}"}]}], "}"}]}], ";", "\n", 
   RowBox[{"coords3D", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3", ",", "y3", ",", "z3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x4", ",", "y4", ",", "z4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x5", ",", "y5", ",", "z5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x6", ",", "y6", ",", "z6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x7", ",", "y7", ",", "z7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x8", ",", "y8", ",", "z8"}], "}"}]}], "}"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9073500837534313`*^9, 3.9073500996248903`*^9}, {
  3.9073503450531445`*^9, 
  3.9073503842857227`*^9}},ExpressionUUID->"091ca0eb-a149-4896-8691-\
69c01685639a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Nodal", " ", "coordinates", " ", "assuming", " ", "rectangular", " ", 
    "grids"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coords1D", "=", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"x1", "+", "dx"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"coords2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "dx"}], ",", "y1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "dx"}], ",", 
         RowBox[{"y1", "+", "dy"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "dy"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"coords3D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", "z1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "dx"}], ",", "y1", ",", "z1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "dx"}], ",", 
         RowBox[{"y1", "+", "dy"}], ",", "z1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "dy"}], ",", "z1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", 
         RowBox[{"z1", "+", "dz"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "dx"}], ",", "y1", ",", 
         RowBox[{"z1", "+", "dz"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x1", "+", "dx"}], ",", 
         RowBox[{"y1", "+", "dy"}], ",", 
         RowBox[{"z1", "+", "dz"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", 
         RowBox[{"y1", "+", "dy"}], ",", 
         RowBox[{"z1", "+", "dz"}]}], "}"}]}], "}"}]}], ";"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.907350362274969*^9, 3.907350365352844*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b2d36da9-f89a-4ce4-91af-8b19f08a23cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Basis", " ", "functions", " ", "for", " ", "1", "D", " ", "linear", " ", 
    "element"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"N1D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], "/", "2"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Basis", " ", "functions", " ", "for", " ", "2", "D", " ", "quad", " ", 
     "element"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"N2D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "eta"}], ")"}], "/", "4"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "eta"}], ")"}], "/", "4"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "eta"}], ")"}], "/", "4"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "eta"}], ")"}], "/", "4"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Basis", " ", "functions", " ", "for", " ", "3", "D", " ", "hex", " ", 
     "element"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"N3D", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "zeta"}], ")"}], "/", "8"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "xi"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "eta"}], ")"}], " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "zeta"}], ")"}], "/", "8"}]}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9073500837534313`*^9, 3.9073501035085726`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"376f5b2b-c56a-45cf-9c0a-bfc56f5e72fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Jacobian"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Jacobian1D", "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"N1D", ".", "coords1D"}], ",", "xi"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Jacobian2D", "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"N2D", ".", "coords2D"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xi", ",", "eta"}], "}"}], ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Jacobian3D", "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"N3D", ".", "coords3D"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xi", ",", "eta", ",", "zeta"}], "}"}], ",", "1"}], "}"}]}],
       "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9073500837534313`*^9, 3.9073501035085726`*^9}, 
   3.9073501375784736`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"0331440b-67b4-4aec-a32b-5f3d59412e71"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Print", " ", "or", " ", "further", " ", "manipulate", " ", "the", " ", 
    "Jacobian"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", "Jacobian1D", "]"}], "\n", 
   RowBox[{"FullSimplify", "[", "Jacobian2D", "]"}], "\n", 
   RowBox[{"FullSimplify", "[", "Jacobian3D", "]"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.9073500837534313`*^9, 3.9073501035085726`*^9}, {
  3.9073501375784736`*^9, 3.907350188762545*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"0802991a-f0e4-4b33-92be-1950e6594149"],

Cell[BoxData[
 FractionBox["dx", "2"]], "Output",
 CellChangeTimes->{3.90735012184888*^9, 3.9073501896767406`*^9, 
  3.9073504331047583`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"0ade20e8-4785-470c-b90a-88faab8b1fb3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["dx", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["dy", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.90735012184888*^9, 3.9073501896767406`*^9, 
  3.9073504331047583`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"4a6f8081-5845-4567-9dc7-2391bd0663cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["dx", "2"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["dy", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["dz", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.90735012184888*^9, 3.9073501896767406`*^9, 
  3.9073504331205916`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"a42c0a0e-c738-4fdd-87a3-c1b16c46061b"]
}, Open  ]]
},
WindowSize->{1536, 773},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 290, 6, 28, "Input",ExpressionUUID->"7b738d86-d858-4b39-b06e-38020fb0a88a"],
Cell[851, 28, 637, 17, 86, "Input",ExpressionUUID->"fcc7a3ef-33f9-47c9-b50e-bbb5e62ca596"],
Cell[1491, 47, 1387, 40, 67, "Input",ExpressionUUID->"091ca0eb-a149-4896-8691-69c01685639a"],
Cell[2881, 89, 2095, 62, 105, "Input",ExpressionUUID->"b2d36da9-f89a-4ce4-91af-8b19f08a23cc"],
Cell[4979, 153, 4042, 125, 181, "Input",ExpressionUUID->"376f5b2b-c56a-45cf-9c0a-bfc56f5e72fc"],
Cell[9024, 280, 1036, 32, 86, "Input",ExpressionUUID->"0331440b-67b4-4aec-a32b-5f3d59412e71"],
Cell[CellGroupData[{
Cell[10085, 316, 582, 12, 105, "Input",ExpressionUUID->"0802991a-f0e4-4b33-92be-1950e6594149"],
Cell[10670, 330, 220, 4, 50, "Output",ExpressionUUID->"0ade20e8-4785-470c-b90a-88faab8b1fb3"],
Cell[10893, 336, 392, 11, 50, "Output",ExpressionUUID->"4a6f8081-5845-4567-9dc7-2391bd0663cf"],
Cell[11288, 349, 506, 14, 50, "Output",ExpressionUUID->"a42c0a0e-c738-4fdd-87a3-c1b16c46061b"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

